### 2. TCP 스트림은 세그먼트로 나뉘어 IP 패킷을 통해 전송된다

TCP는 세그먼트라는 단위로 데이터 스트림을 잘게 나누고, 세그먼트를 IP 패킷(혹은 IP 데이터그램)이라고 불리는 봉투에 담아서 인터넷을 통해 데이터를 전달한다.

각 TCP 세그먼트는 하나의 IP 주소에서 다른 IP 주소로 IP 패킷에 담겨 전달된다.

이 IP 패킷들 각각은 다음을 포함한다.

- IP 패킷 헤더(보통 20바이트)
- TCP 세그먼트 헤더(보통 20바이트)
- TCP 데이터 조각(0 혹은 그 이상의 바이트)

IP 헤더는 발신지와 목적지 IP 주소, 크기, 기타 플래그를 가진다.

TCP 세그먼트 헤더는 TCP 포트 번호, TCP 제어 플래그, 그리고 데이터의 순서와 무결성을 검사하기 위해 사용되는 숫자 값을 포함한다.

<img width="500" alt="" src="https://github.com/user-attachments/assets/d40813d6-27a7-4a53-9b46-63a39d9f8b9d" />

### 3. TCP 커넥션 유지하기

컴퓨터는 항상 TCP 커넥션을 여러 개 가지고 있다.

TCP는 포트 번호를 통해서 이런 여러 개의 커넥션을 유지한다.

TCP 커넥션은 네 가지 값으로 식별한다.

`<발신지 IP 주소, 발신지 포트, 수신지 IP 주소, 수신지 포트>`

이 네 가지 값으로 유일한 커넥션을 생성한다.

### 4. TCP 소켓 프로그래밍

운영체제는 TCP 커넥션의 생성과 관련된 여러 기능을 제공한다.

소켓 API는 HTTP 프로그래머에게 TCP와 IP의 세부사항들을 숨긴다.

<img width="500" alt="" src="https://github.com/user-attachments/assets/849834b7-f192-439f-b72a-3e480c02b4ee" />

소켓 API를 사용하면, TCP 종단(endpoint) 데이터 구조를 생성하고, 원격 서버의 TCP 종단에 그 종단 데이터 구조를 연결하여 데이터 스트림을 읽고 쓸 수 있다.

<img width="500" alt="" src="https://github.com/user-attachments/assets/fde75b19-c16f-446a-9e78-a51352540f74" />

커넥션 생성은 서버와의 거리, 서버의 부하, 인터넷 혼잡도에 따라서 시간이 걸린다.
