## 8. 값 vs 타입

클래스와 마찬가지로 타입스크립트 문법인 enum 역시 런타임에 객체로 변환되는 값이다.

```typescript
enum Direction {
  Up, // 0
  Down, // 1
  Left, // 2
  Right, // 3
}
```

enum 예시를 순수 자바스크립트 코드로 컴파일하면 다음과 같다.

```javascript
"use strict";
var Direction;
(function (Direction) {
  Direction[(Direction["Up"] = 0)] = "Up";
  Direction[(Direction["Down"] = 1)] = "Down";
  Direction[(Direction["Left"] = 2)] = "Left";
  Direction[(Direction["Right"] = 3)] = "Right";
})(Direction || (Direction = {}));
```

### Q. `enum`, `const enum`, `as const` 중에 뭘 쓰는 게 나을까?

1. `enum`은 자바스크립트로 변환될 때 즉시실행함수(IIFE)로 실행되어 객체로 남는다. 런타임에서 실제 값으로도 사용될 수 있다는 장점이 있지만, 트리쉐이킹이 안 된다는 단점이 있다. 트리쉐이킹이 안 되면 번들 사이즈가 늘어날 수 있기 때문이다.

- 배달이팀: 사실 enum을 쓴다고 해서 전체 파일의 번들 사이즈가 서비스에 영향을 미칠정도로 커지지 않으니 크게 고민하지는 않아요.
- 메이팀: enum은 사용하기에는 되게 편한데 자바스크립트로 컴파일될 때 IIFE로 바뀌는 게 크진 않지만 성능에 영향을 줄 수 있다는 것을 본 것 같아서 그 이후로는 습관적으로 안 쓰기 시작했어요.

2. `const enum`은 자바스크립트로 변환될 때 참조한 곳에 값이 치환되는 방식이라 트리쉐이킹이 된다는 장점이 있다. 그러나 치환되는 방식으로 인해 빌드된 코드와 런타임의 코드 간 차이가 발생해 버전 문제가 생길 수 있다는 단점이 있다.

- 타입스크립트 프로그래밍 49p: const enum은 기본적으로 아무 자바스크립트도 생성하지 않으며 그 대신 필요한 곳에 열거형 멤버의 값을 채워 넣는다(예를 들어 타입스크립트는 Language.Spanish가 사용된 모든 코드를 값 1로 바꾼다).
- 타입스크립트 프로그래밍 50p: 누군가의 타입스크립트 코드에 정의된 const enum을 가져왔을 때는 이 채워 넣기 기능이 문제를 일으킬 수 있다. 개발자가 타입스크립트 코드를 컴파일한 이후에 열거형을 만든 사람이 자신의 const enum을 갱신하면 런타임에 같은 열거형이 버전에 따라 다른 값을 갖게 되고, 타입스크립트가 이 상황에서 할 수 있는 일은 없다. const enum을 사용할 때는 채워 넣기 기능을 되도록 피해야 하며 여러분이 제어할 수 있는 타입스크립트 프로그램에서만 사용해야 한다. NPM으로 배포하거나 라이브러리로 제공할 프로그램에서는 const enum을 사용하지 말아야 한다.

예를 들어, 어떤 사람이 const enum을 정의하고, 이걸 NPM에 라이브러리로 올린 상황이라고 해보자.

당신은 이 라이브러리를 받아서 LogLevel.Info를 코드에 썼다.

컴파일하면 숫자 1로 대체된다. (채워 넣기 기능)

나중에 enum 정의자가 순서를 바꿨다고 해보자.

```typescript
export const enum LogLevel {
  Debug,
  Warn, // 순서 바뀜
  Info,
  Error,
}
```

이제 Info = 2가 됐다.

그런데 당신은 enum을 여전히 1로 쓰고 있다. (이미 컴파일된 코드니까)

결국 런타임에서 서로 다른 enum 값이 존재하고, 버그가 발생할 수 있다.

3. 그래서 난 `as const` 방식을 선호한다. 즉시실행함수로 객체가 생성되지 않는 단순 상수 객체이기 때문에, 모듈 번들러가 CommonJS가 아닌 ESM처럼 트리쉐이킹 지원하는 번들러라면 트리쉐이킹 된다.
